if (self.CavalryLogger) { CavalryLogger.start_js(["spiOc"]); }

__d("CampfireCommands",[],(function a(b,c,d,e,f,g){var h=Object.freeze({TOGGLE_LINK:"TOGGLE_LINK",SAVE_DRAFT:"SAVE_DRAFT"});f.exports=h}),null);
__d("getCampfireKeyBinding",["CampfireCommands","KeyBindingUtil","getDefaultKeyBinding"],(function a(b,c,d,e,f,g){"use strict";var h=c("KeyBindingUtil").hasCommandModifier;function i(j){if(j.keyCode===75&&h(j))return c("CampfireCommands").TOGGLE_LINK;if(j.keyCode===83&&h(j))return c("CampfireCommands").SAVE_DRAFT;return c("getDefaultKeyBinding")(j)}f.exports=i}),null);
__d("keyCommandBackspaceEmoji",["EditorState","EmojiRenderer","UnicodeUtils","moveSelectionBackward","removeTextWithStrategy"],(function a(b,c,d,e,f,g){__p&&__p();var h=function h(i){__p&&__p();var j=c("removeTextWithStrategy")(i,function(l){__p&&__p();var k=l.getSelection(),m=k.getAnchorOffset(),n=l.getCurrentContent().getBlockForKey(k.getAnchorKey()).getText(),o=n[m-1],p=null;if(o){var q=c("EmojiRenderer").parse(n);for(var r=0;r<q.length;r++)if(q[r].offset<m&&q[r].offset+q[r].length>=m){p=q[r].length;break}if(!p)p=c("UnicodeUtils").getUTF16Length(o,0)}return c("moveSelectionBackward")(l,p||1)},"backward");if(j===i.getCurrentContent())return null;var k=i.getSelection();return c("EditorState").push(i,j.set("selectionBefore",k),k.isCollapsed()?"backspace-character":"remove-range")};f.exports=h}),null);
__d("keyCommandDeleteEmoji",["EditorState","EmojiRenderer","UnicodeUtils","moveSelectionForward","removeTextWithStrategy"],(function a(b,c,d,e,f,g){__p&&__p();var h=function h(i){__p&&__p();var j=c("removeTextWithStrategy")(i,function(l){__p&&__p();var k=l.getSelection(),m=k.getAnchorOffset(),n=l.getCurrentContent().getBlockForKey(k.getAnchorKey()).getText(),o=n[m],p=null;if(o){var q=c("EmojiRenderer").parse(n);for(var r=0;r<q.length;r++)if(q[r].offset<=m&&q[r].offset+q[r].length>m){p=q[r].length;break}if(!p)p=c("UnicodeUtils").getUTF16Length(o,0)}return c("moveSelectionForward")(l,p||1)},"forward");if(j===i.getCurrentContent())return null;var k=i.getSelection();return c("EditorState").push(i,j.set("selectionBefore",k),k.isCollapsed()?"delete-character":"remove-range")};f.exports=h}),null);
__d("addEmojiInput",["EditorState","EmojiInputDecorator","EmojiSpan.react","React","keyCommandBackspaceEmoji","keyCommandDeleteEmoji"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h=function(i){__p&&__p();return function(){__p&&__p();var j,k;j=babelHelpers.inherits(l,c("React").Component);k=j&&j.prototype;function l(){__p&&__p();var m,n;"use strict";for(var o=arguments.length,p=Array(o),q=0;q<o;q++)p[q]=arguments[q];return n=(m=k.constructor).call.apply(m,[this].concat(p)),this.$_class1=function(r,s){__p&&__p();var t=null;switch(r){case"backspace":t=c("keyCommandBackspaceEmoji")(s);break;case"delete":t=c("keyCommandDeleteEmoji")(s);break}if(t){this.props.onChange(t);return"handled"}return"not-handled"}.bind(this),n}l.prototype.blur=function(){"use strict";var m=this.refs.component;m&&typeof m.blur==="function"&&m.blur()};l.prototype.click=function(){"use strict";var m=this.refs.component;m&&typeof m.click==="function"&&m.click()};l.prototype.focus=function(){"use strict";var m=this.refs.component;m&&typeof m.focus==="function"&&m.focus()};l.prototype.render=function(){"use strict";var m=this.props.editorState,n=m.getDecorator();if(!(n instanceof c("EmojiInputDecorator")))m=c("EditorState").set(this.props.editorState,{decorator:new(c("EmojiInputDecorator"))(c("EmojiSpan.react"),n,{size:16})});return c("React").createElement(i,babelHelpers["extends"]({},this.props,{editorState:m,handleKeyCommand:this.$_class1,ref:"component"}))};return l}()}.bind(this);f.exports=h}),null);
__d("addEmojiToEditorState",["DraftModifier","EditorState","EmojiFormat","emptyFunction"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();function h(i,j){var k=arguments.length<=2||arguments[2]===undefined?c("emptyFunction"):arguments[2];if(typeof i!=="string")i=c("EmojiFormat").codeArrayToUnicode(i);var l=c("DraftModifier").replaceText(j.getCurrentContent(),j.getSelection(),i),m=c("EditorState").push(j,l,"insert-characters");if(m!==j)k(m);return m}f.exports=h}),null);
__d("ScrollColumn.react",["cx","invariant","SubscriptionsHandler","joinClasses","throttle","tidyEvent","Arbiter","Event","React","ReactDOM","Vector","ViewportBounds"],(function a(b,c,d,e,f,g,h,i){__p&&__p();var j=c("React").PropTypes,k="ScrollColumn/adjust",l=c("React").createClass({displayName:"ScrollColumn",_subscriptionsHandler:null,propTypes:{left:j.string,topOffset:j.number,zIndex:j.number},getDefaultProps:function m(){return{left:"",topOffset:0,zIndex:0}},_scroll:0,_scrollDelta:0,getInitialState:function m(){return{fixed:null,fixedBottom:0,fixedTop:this.props.topOffset,top:0}},render:function m(){__p&&__p();var n="auto",o=this.state.fixedLeft,p="auto";if(this.state.fixed==="bottom")n=this.state.fixedBottom;else if(this.state.fixed==="top")p=this.state.fixedTop;else{o="auto";p=this.state.top}var q=c("joinClasses")(this.props.className,"_5ss7");return c("React").createElement("div",{className:q,ref:"container"},c("React").createElement("div",{className:"_5ss8"+(this.state.fixed?" fixed_always":""),ref:"column",style:{bottom:n,left:o,top:p,zIndex:this.props.zIndex}},this.props.children))},componentDidMount:function m(){this._subscriptionsHandler=new(c("SubscriptionsHandler"))();this._subscriptionsHandler.addSubscriptions(c("tidyEvent")(c("Arbiter").subscribe(k,function(){this._adjust()}.bind(this))),c("tidyEvent")(c("Event").listen(window,"resize",c("throttle")(this._adjust))),c("tidyEvent")(c("Event").listen(window,"scroll",this._onScroll)),c("tidyEvent")(c("ViewportBounds").subscribe("change",this._adjust)));this._adjust()},componentDidUpdate:function m(n,o){if(o.fixed!==this.state.fixed)c("Arbiter").inform("reflow")},componentWillUnmount:function m(){this._subscriptionsHandler&&this._subscriptionsHandler.release()},_onScroll:function m(event){var n=c("Vector").getScrollPosition().y;this._scrollDelta=n-this._scroll;this._scroll=n;this._adjust()},_adjust:function m(){__p&&__p();if(!this.isMounted())return;this._updateContainerHeight();this._updateColumnWidth();if(this._isContainerBelowViewportTop()){this._setNotFixed(0);return}if(!this._isColumnLargerThanViewport()){this._setFixedToTop();return}if(this._scrollDelta>0)if(this._isBottomOfColumnVisible()){this._setFixedToBottom();return}if(this._scrollDelta<0)if(this._isTopOfColumnVisible()){this._setFixedToTop();return}var n=this._getTopPositionForRef("column"),o=this._getTopPositionForRef("container"),p=n-o;this._setNotFixed(p)},_getTopPositionForRef:function m(n){var o=this.refs[n];o||i(0);var p=c("Vector").getElementPosition(c("ReactDOM").findDOMNode(o),"viewport").y;if(this._scroll<0)p+=this._scroll;return p},_getTopBoundWithOffset:function m(){return c("ViewportBounds").getTop()+this.props.topOffset},_isContainerBelowViewportTop:function m(){var n=this._getTopPositionForRef("container");return n>=this._getTopBoundWithOffset()},_isColumnLargerThanViewport:function m(){var n=c("Vector").getViewportDimensions().y-c("ViewportBounds").getBottom()-this._getTopBoundWithOffset();return c("ReactDOM").findDOMNode(this.refs.column).offsetHeight>n},_isBottomOfColumnVisible:function m(){var n=this._getTopPositionForRef("column"),o=c("Vector").getElementDimensions(c("ReactDOM").findDOMNode(this.refs.column),"viewport").y,p=n+o;return p<=c("Vector").getViewportDimensions().y-c("ViewportBounds").getBottom()},_isTopOfColumnVisible:function m(){var n=this._getTopPositionForRef("column");return n>=this._getTopBoundWithOffset()},_getFixedLeft:function m(){return c("Vector").getElementPosition(c("ReactDOM").findDOMNode(this.refs.container),"viewport").x},_setFixedToBottom:function m(){this.setState({fixed:"bottom",fixedBottom:c("ViewportBounds").getBottom(),fixedLeft:this.props.left===""?this._getFixedLeft():this.props.left})},_setFixedToTop:function m(){this.setState({fixed:"top",fixedLeft:this.props.left===""?this._getFixedLeft():this.props.left,fixedTop:this._getTopBoundWithOffset()})},_setNotFixed:function m(n){this.setState({fixed:false,top:n})},_updateContainerHeight:function m(){c("ReactDOM").findDOMNode(this.refs.container).style.height=c("ReactDOM").findDOMNode(this.refs.column).offsetHeight+this.state.top+"px"},_updateColumnWidth:function m(){c("ReactDOM").findDOMNode(this.refs.column).style.width=c("ReactDOM").findDOMNode(this.refs.container).offsetWidth+"px"}});l.EVENT_SHOULD_ADJUST=k;f.exports=l}),null);
__d("DocumentUploadConfig",["DocumentUploadConfigInitialData"],(function a(b,c,d,e,f,g){var h={isSupported:function i(j){if(!j)return false;if(c("DocumentUploadConfigInitialData").CONTENT_TYPES.length<=0)return false;return c("DocumentUploadConfigInitialData").CONTENT_TYPES.includes(j)}};f.exports=h}),null);
__d("ComposerXDragDropUtils",["csx","Arbiter","CSS","DocumentUploadConfig","DOMQuery","Parent","VideoUploadFeatureDetector"],(function a(b,c,d,e,f,g,h){__p&&__p();var i={handleDragEnterAndLeave:function j(k){var l=c("DOMQuery").scry(c("Parent").bySelector(k,"._119"),"._2wr");c("Arbiter").subscribe("dragenter",function(m,n){if(k==n.element)l.forEach(c("CSS").hide)});c("Arbiter").subscribe("dragleave",function(m,n){if(k==n.element)l.forEach(c("CSS").show)})},filterImages:function j(k){__p&&__p();var l=c("VideoUploadFeatureDetector").supportsFileAPI(),m=[];for(var n=0;n<k.length;n++){var o=k[n];if(o.type.match("image/*"))m.push(o);else if(l&&o.type.match("video/*"))m.push(o);else if(c("DocumentUploadConfig").isSupported(o.type))m.push(o)}return m}};f.exports=i}),null);
__d("MNPageComposerUtils",["QE2Logger"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h="product_tagging_minimum_number_products";i.prototype.shouldShowMessagingButton=function(j,k,l,m,n,o,p){var q=j&&j>1&&p!=null&&p;return q||!(j&&j>1||k&&k>1||!j&&!k||l||m||n||o)};i.prototype.isProductTaggerPostButtonDisabled=function(j,k){if(j>0)c("QE2Logger").logExposureForUser(h);return j>0&&j<k};function i(){}f.exports=new i()}),null);
__d("VertexScrollColumn.react",["DOMContainer.react","React","ScrollColumn.react"],(function a(b,c,d,e,f,g){__p&&__p();var h,i,j=c("React").PropTypes,k=5,l=10;h=babelHelpers.inherits(m,c("React").Component);i=h&&h.prototype;m.prototype.render=function(){"use strict";var n=c("React").createElement(c("ScrollColumn.react"),{topOffset:l,ref:"scrollColumn",zIndex:k},c("React").createElement(c("DOMContainer.react"),null,this.props.content));return n};function m(){"use strict";h.apply(this,arguments)}m.propTypes={content:j.object.isRequired};f.exports=m}),null);
__d("ReactComposerStatusAttachmentMentionsInput.react",["cx","addEmojiInput","Arbiter","MentionsInput.react","React","ReactComponentWithPureRenderMixin","ReactComposerConfig","ReactComposerContextTypes","ReactComposerEvents","ReactComposerInit","ReactComposerTaggerType","SubscriptionsHandler","XUITypeaheadView.react","ifRequired","joinClasses"],(function a(b,c,d,e,f,g,h){__p&&__p();var i=c("React").PropTypes,j=c("addEmojiInput")(c("MentionsInput.react")),k=c("React").createClass({displayName:"ReactComposerStatusAttachmentMentionsInput",_subscriptions:undefined,contextTypes:c("ReactComposerContextTypes"),mixins:[c("ReactComponentWithPureRenderMixin")],propTypes:{config:c("ReactComposerConfig"),mentionsSource:i.object,preventFocus:i.bool,typeaheadReporter:i.object,onChange:i.func,onFocus:i.func,onPasteFiles:i.func},componentWillUnmount:function l(){this.props.onBlur&&this.props.onBlur(this.props.editorState);this._subscriptions&&this._subscriptions.release()},componentWillMount:function l(){var m=new(c("SubscriptionsHandler"))();if(!this.props.preventFocus)m.addSubscriptions(c("Arbiter").subscribe([c("ReactComposerEvents").ACTIVATE_ATTACHMENT+this.context.composerID],function(){return this.focus()}.bind(this)));this._subscriptions=m},componentDidCatch:function l(m,n){},render:function l(){var m=this.props.config&&this.props.taggersConfig&&this.props.config.taggersConfig[c("ReactComposerTaggerType").PEOPLE],n=m&&m.typeaheadView?m.typeaheadView:c("XUITypeaheadView.react"),o=m&&m.typeaheadViewProps?m.typeaheadViewProps:{},p=Object.assign({},{ariaMultiline:true,role:"textbox",typeaheadView:n,typeaheadViewProps:o,selectOnTab:false,spellCheck:true},this.props,{className:c("joinClasses")("_1mwp navigationFocus",this.props.className),editorState:this.props.editorState,onAddMention:this._onAddMention,onShowMentions:this._onShowMentions,onFocus:this._onFocus,onBlur:this._onBlur,onChange:this._onChange,maxResults:10});return c("React").createElement(j,babelHelpers["extends"]({ref:"mentionsInput"},p,{webDriverTestID:"status-attachment-mentions-input"}))},focus:function l(){if(!c("ReactComposerInit").isInstanceMounted(this.context.composerID))c("Arbiter").subscribeOnce([c("ReactComposerEvents").INSTANCE_MOUNTED+this.context.composerID],function(){return this.refs&&this.refs.mentionsInput&&this.refs.mentionsInput.focus()}.bind(this));else this.refs&&this.refs.mentionsInput&&this.refs.mentionsInput.focus()},blur:function l(){this.refs&&this.refs.mentionsInput&&this.refs.mentionsInput.blur()},_onAddMention:function l(m,n,o){var p=this.props.typeaheadReporter;if(p){p.reportSelect(m.getUniqueID(),m.getType(),n,o.button>=0);p.sessionEnd();p.sessionStart()}if(m.getType()==="event")c("ifRequired")("ReactComposerEventAttachmentActions",function(q){return q.fetchEventAttachment(this.context.composerID,m.getUniqueID())}.bind(this))},_onShowMentions:function l(m,n){var o=this.props.typeaheadReporter;if(o)o.reportResults(m.map(function(p){return p.getUniqueID()}))},_onFocus:function l(){var m=this.props.typeaheadReporter;if(m)m.sessionStart();this.props.onFocus&&this.props.onFocus()},_onChange:function l(m){this.props.onChange&&this.props.onChange(m)},_onBlur:function l(){this.props.typeaheadReporter&&this.props.typeaheadReporter.sessionEnd();this.props.onBlur&&this.props.onBlur(this.props.editorState)}});f.exports=k}),null);
__d("ReactComposerStatusAttachmentMentionsInputVariant.react",["cx","EmojiInputButton.react","Keys","React","ReactComposerActions","ReactComposerAttachmentType","ReactComposerStatusAttachmentMentionsInput.react","ReactComposerStickerContainer","UserAgent_DEPRECATED","emptyFunction","getCampfireKeyBinding","joinClasses"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j,k=c("ReactComposerStickerContainer").ReactComposerStickerComponent;i=babelHelpers.inherits(l,c("React").Component);j=i&&i.prototype;function l(m){__p&&__p();j.constructor.call(this,m);this.$ReactComposerStatusAttachmentMentionsInputVariant1=function(n){var o=/^image\//;n=n.filter(function(p){return o.test(p.type)});if(n.length>0&&this.props.onPasteFiles){this.props.onPasteFiles(n);return true}return false}.bind(this);this.$ReactComposerStatusAttachmentMentionsInputVariant2=function(event,n){var o=c("UserAgent_DEPRECATED").osx()?event.metaKey:event.ctrlKey;if(event.keyCode===c("Keys").RETURN&&o){this.blur();setTimeout(this.props.onPostIntent,0);return true}return false}.bind(this);this.$ReactComposerStatusAttachmentMentionsInputVariant3=function(){c("ReactComposerActions").expandSprouts(this.props.compositionID)}.bind(this)}l.prototype.render=function(){__p&&__p();var m=this.props.config&&this.props.config.attachmentsConfig[c("ReactComposerAttachmentType").STATUS],n=null;if(this.props.useRichTextEditor){var o=m.richTextEditor;n=c("React").createElement(o,babelHelpers["extends"]({},this.props,{className:c("joinClasses")(this.props.className,"_3w8y _21mu"+(this.props.sticker&&this.props.sticker.stickerID?" _n7q":"")),canAttachVideo:false,canAttachPhoto:false,canAttachEmbed:false,onSave:c("emptyFunction"),spellCheck:true,autoCorrect:false,handlePastedFiles:this.$ReactComposerStatusAttachmentMentionsInputVariant1,handleContentReturn:this.$ReactComposerStatusAttachmentMentionsInputVariant2,keyBindingFn:c("getCampfireKeyBinding"),ref:"mentionsInput"}))}else n=c("React").createElement(c("ReactComposerStatusAttachmentMentionsInput.react"),babelHelpers["extends"]({},this.props,{className:c("joinClasses")(this.props.className,(this.props.isSelectedAttachmentActive?"_1mwq":"")+(this.props.config&&this.props.config.showExpandedComposer?" _4c_p":"")+(m&&m.showProfilePic?" _5bu_":"")+(this.props.isPosting?" _1udp":"")+(this.props.shouldUseLargeText?" _17nh":"")+(m&&m.largeTextThreshold?" _34nd":"")+" _21mu"+(this.props.sticker&&this.props.sticker.stickerID?" _hjn":"")),ref:"mentionsInput",readOnly:this.props.isPosting,editorState:this.props.editorState,mentionsSource:this.props.mentionsSource,typeaheadReporter:this.props.typeaheadReporter,handlePastedFiles:this.$ReactComposerStatusAttachmentMentionsInputVariant1,handleContentReturn:this.$ReactComposerStatusAttachmentMentionsInputVariant2}));var p="_3nc-",q="_3nc_",r="_5zq9",s=c("React").createElement(c("EmojiInputButton.react"),{buttonClassName:p,iconActiveClassName:r,iconClassName:q,onSelect:this.props.onInsertEmoji,onClick:this.$ReactComposerStatusAttachmentMentionsInputVariant3}),t=null;if(k)t=c("React").createElement(k,{sticker:this.props.sticker,composerID:this.props.compositionID});return c("React").createElement("div",{className:"_3nd0"},t,n,s)};l.prototype.blur=function(){this.refs&&this.refs.mentionsInput&&this.refs.mentionsInput.blur()};l.prototype.focus=function(){this.refs&&this.refs.mentionsInput&&this.refs.mentionsInput.focus()};f.exports=l}),null);
__d("ReactComposerStatusAttachmentMentionsInputContainer.react",["Arbiter","EditorState","LitestandStoryInsertionStatus","React","ReactComponentWithPureRenderMixin","ReactComposerActions","ReactComposerAttachmentStore","ReactComposerAttachmentType","ReactComposerConfig","ReactComposerContextTypes","getReactComposerEmojiInputDecorator","ReactComposerEvents","ReactComposerOptimisticPostingActions","ReactComposerHandleUnsavedChanges","ReactComposerInputDecorator","ReactComposerMediaUploadStore","ReactComposerMinutiaeAttachmentStore","ReactComposerPropsAndStoreBasedStateMixin","ReactComposerScrapedAttachmentStore","ReactComposerStatusActions","ReactComposerStatusAttachmentMentionsInputVariant.react","ReactComposerStatusStore","ReactComposerStatusUtils","ReactComposerStore","ReactComposerTaggerStore","ReactComposerTaggerType","TextDelightEvents","UnicodeUtils","addEmojiToEditorState","ifRequired"],(function a(b,c,d,e,f,g){__p&&__p();var h=c("React").PropTypes,i=function i(k,l){var m=c("ReactComposerAttachmentStore").getSelectedAttachmentID(k);if(m===c("ReactComposerAttachmentType").LIVE_VIDEO||m===c("ReactComposerAttachmentType").SELL)return false;var n=l&&l.attachmentsConfig[c("ReactComposerAttachmentType").STATUS],o=c("ReactComposerTaggerStore").hasMarkdown(k);return!!(n&&n.richTextEditor&&!o)},j=c("React").createClass({displayName:"ComposerStatusAttachmentMentionsInputContainer",_rerenderSubscription:undefined,contextTypes:c("ReactComposerContextTypes"),mixins:[c("ReactComponentWithPureRenderMixin"),c("ReactComposerPropsAndStoreBasedStateMixin")(c("ReactComposerAttachmentStore"),c("ReactComposerMediaUploadStore"),c("ReactComposerMinutiaeAttachmentStore"),c("ReactComposerScrapedAttachmentStore"),c("ReactComposerStatusStore"),c("ReactComposerStore"),c("ReactComposerTaggerStore"))],propTypes:{config:c("ReactComposerConfig"),mentionsEnabled:h.bool,mentionsSource:h.object,onChange:h.func,onFocus:h.func,onPasteFiles:h.func,handlePastedText:h.func},getDefaultProps:function k(){return{mentionsEnabled:true}},getInitialState:function k(){return{isFocused:false}},statics:{calculateState:function k(l,m){__p&&__p();var n=c("ReactComposerStatusStore").getEditorState(l),o=m.config&&m.config.attachmentsConfig[c("ReactComposerAttachmentType").STATUS],p=false,q=c("ReactComposerStatusStore").getTextLength(l),r=c("ReactComposerAttachmentStore").isSelectedAttachmentActive(l),s=c("ReactComposerAttachmentStore").getSelectedAttachmentID(l),t=i(l,m.config),u=c("ReactComposerInputDecorator").NONE;if(m.mentionsEnabled)u=o&&o.richTextEditor?c("ReactComposerInputDecorator").RICH_TEXT:c("ReactComposerInputDecorator").MENTIONS;if(o&&o.largeTextThreshold&&c("ReactComposerMediaUploadStore").getUploadsCount(l)===0&&!c("ReactComposerScrapedAttachmentStore").hasAttachment(l)&&!c("ReactComposerTaggerStore").hasExplicitLocation(l)&&!c("ReactComposerTaggerStore").hasMarkdown(l)&&c("ReactComposerMinutiaeAttachmentStore").getMarkup(l)===null&&s!==c("ReactComposerAttachmentType").FIND_PLAYERS&&s!==c("ReactComposerAttachmentType").SELL){if(!q&&n){var v=n.getCurrentContent();q=c("UnicodeUtils").strlen(v.getPlainText())}var w=m.config.attachmentsConfig[c("ReactComposerAttachmentType").STATUS].placeholderText;if(w&&w.length<=o.LargePlaceholderTextThreshold&&q===0&&r||q!==0&&q<=o.largeTextThreshold)p=true;c("ifRequired")("ReactComposerFormattedTextStore",function(z){var A=z.getSelectedIndex(l);if(A>-1){p=true;u=m.mentionsEnabled?c("ReactComposerInputDecorator").MENTIONS:c("ReactComposerInputDecorator").NONE;t=false}})}var x=c("getReactComposerEmojiInputDecorator")(u,p&&!t?28:16),y=void 0;if(n)if(n.getDecorator()!==x){y=c("EditorState").set(n,{decorator:x});c("ReactComposerStatusActions").setEditorState(l,y)}else y=n;else{y=c("EditorState").createEmpty(x);c("ReactComposerStatusActions").setEditorState(l,y)}return{activeEditorState:c("ReactComposerStatusStore").getActiveEditorState(l),editorState:y,isSelectedAttachmentActive:c("ReactComposerAttachmentStore").isSelectedAttachmentActive(l),mentionsSource:m.mentionsEnabled?c("ReactComposerStatusStore").getMentionsSource(l):null,posting:c("ReactComposerStore").isPosting(l),typeaheadReporter:c("ReactComposerStatusStore").getTypeaheadReporter(l),shouldUseLargeText:p,selectedSticker:c("ReactComposerTaggerStore").getTaggerData(l,c("ReactComposerTaggerType").STICKER),useRichText:t}}},componentWillMount:function k(){if(this.props.mentionsSource)c("ReactComposerStatusActions").setMentionsSource(this.context.composerID,this.props.mentionsSource);this._storyInsertionBlocker=c("LitestandStoryInsertionStatus").registerBlocker(function(){return c("ReactComposerHandleUnsavedChanges").hasUnsavedChanges(this.context.composerID)||this.state.isFocused}.bind(this))},componentDidMount:function k(){var l=c("ReactComposerStatusStore").getEditorState(this.context.composerID);if(this.state.editorState!==l){this._pendingEditorStateUpdateFromMount=l;this.setState({editorState:l},function(){this._pendingEditorStateUpdateFromMount=undefined}.bind(this))}this._rerenderSubscription=c("Arbiter").subscribe(c("ReactComposerEvents").RERENDER_MENTION_INPUT+this.context.composerID,function(){this.setState({editorState:c("ReactComposerStatusStore").getEditorState(this.context.composerID)})}.bind(this))},componentWillReceiveProps:function k(l){if(this.props.mentionsSource!==l.mentionsSource)c("ReactComposerStatusActions").setMentionsSource(this.context.composerID,l.mentionsSource);if(l.editorState===null){var m=c("EditorState").createEmpty(c("getReactComposerEmojiInputDecorator")(c("ReactComposerInputDecorator").MENTIONS));c("ReactComposerStatusActions").setEditorState(this.context.composerID,m);this.setState({editorState:m})}},componentWillUnmount:function k(){this._prefillSubscription&&this._prefillSubscription.unsubscribe();this._prefillSubscription=null;this._storyInsertionBlocker&&this._storyInsertionBlocker.unsubscribe();this._storyInsertionBlocker=null;this._rerenderSubscription&&this._rerenderSubscription.unsubscribe()},render:function k(){return c("React").createElement(c("ReactComposerStatusAttachmentMentionsInputVariant.react"),babelHelpers["extends"]({},this.props,{activeEditorState:this.state.activeEditorState,compositionID:this.context.composerID,editorState:this.state.editorState,isSelectedAttachmentActive:this.state.isSelectedAttachmentActive,isPosting:this.state.posting,mentionsSource:this.state.mentionsSource,onBlur:this._onBlur,onChange:this._onChange,onFocus:this._onFocus,onInsertEmoji:this._onInsertEmoji,onPostIntent:this._onPostIntent,ownerID:this.context.actorID,ref:"mentionsInput",shouldUseLargeText:this.state.shouldUseLargeText,typeaheadReporter:this.state.typeaheadReporter,useRichTextEditor:this.state.useRichText,sticker:this.state.selectedSticker}))},focus:function k(){this.refs&&this.refs.mentionsInput&&this.refs.mentionsInput.focus();if(this._pendingEditorStateUpdateFromMount!==undefined)this.setState({editorState:this._pendingEditorStateUpdateFromMount},function(){return this.refs&&this.refs.mentionsInput&&this.refs.mentionsInput.focus()}.bind(this))},_onFocus:function k(){c("Arbiter").inform(c("ReactComposerEvents").MENTION_INPUT_FOCUS+this.context.composerID);this.setState({isFocused:true});this.props.onFocus&&this.props.onFocus()},_onChange:function k(l){__p&&__p();if(this._pendingEditorStateUpdateFromMount!==undefined)return;var m=0;if(l){var n=l.getCurrentContent();m=n?c("UnicodeUtils").strlen(n.getPlainText()):0;if(c("ReactComposerStatusStore").getEditorState(this.context.composerID)!==l){c("ReactComposerStatusActions").setEditorState(this.context.composerID,l);c("ReactComposerStatusActions").setTextLength(this.context.composerID,m);if(n)c("TextDelightEvents").emitScrapablePost(n.getPlainText())}}this._handleMarkdownChange(l);this.props.onChange&&this.props.onChange(l);this.setState({editorState:l})},_onInsertEmoji:function k(l){var m=c("ReactComposerStatusStore").getActiveEditorState(this.context.composerID),n=c("ReactComposerStatusStore").getActiveLanguageDialect(this.context.composerID);c("addEmojiToEditorState")(l,m,n==null?this._onChange:this._onMultilingualEditorChange)},_onMultilingualEditorChange:function k(l){var m=this.context.composerID,n=c("ReactComposerStatusStore").getActiveEditorState(m),o=c("ReactComposerStatusStore").getActiveLanguageDialect(m);if(n!==l)c("ifRequired")("ReactComposerMultilingualStatusActions",function(p){p.setEditorState(m,o,l)})},_handleMarkdownChange:function k(l){var m=this.props.config?this.props.config.attachmentsConfig[c("ReactComposerAttachmentType").STATUS]:null;c("ReactComposerStatusUtils").handleMarkdownPreview(this.context.composerID,this.context.targetID,m?m.markdownPreviewAttachment:null,l)},_onBlur:function k(l){c("ReactComposerStatusActions").setEditorState(this.context.composerID,l);this.setState({isFocused:false})},_onPostIntent:function k(){if(this.context.gks.optimisticPosting)c("ReactComposerOptimisticPostingActions").startOptimisticallyPosting(this.context.composerID,this.props.config,c("ReactComposerAttachmentType").STATUS,this.context.actorID,this.context.targetID);else c("ReactComposerActions").postIntended(this.context.composerID,{actorID:this.context.actorID,config:this.props.config,targetID:this.context.targetID})}});f.exports=j}),null);
__d("ReactComposerStatusMentionsUtils",[],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h={getMentionsFromEditorState:function i(j){__p&&__p();var k=j.getCurrentContent(),l={};k.getBlockMap().forEach(function(m){__p&&__p();var n=m.getText();m.findEntityRanges(function(){return true},function(o,p){var q=m.getEntityAt(o);if(!q)return;var r=k.getEntity(q);if(r.getType()!=="MENTION"||r.getData().type!=="user")return;var s=r.getData().id;l[s]={type:"user",uid:s,text:n.slice(o,p),isWeak:r.getData().isWeak}})});return l}};f.exports=h}),null);
__d("ReactComposerStatusAttachmentMentionsInputWithTagExpansionContainer.react",["cx","React","ReactComponentWithPureRenderMixin","ReactComposerContextTypes","ReactComposerStatusActions","ReactComposerStatusAttachmentMentionsInputContainer.react","ReactComposerStatusMentionsUtils","joinClasses"],(function a(b,c,d,e,f,g,h){var i=c("React").createClass({displayName:"ComposerStatusAttachmentMentionsInputWithTagExpansionContainer",contextTypes:c("ReactComposerContextTypes"),mixins:[c("ReactComponentWithPureRenderMixin")],render:function j(){var k=c("joinClasses")(this.props.className,"_395");return c("React").createElement(c("ReactComposerStatusAttachmentMentionsInputContainer.react"),babelHelpers["extends"]({},this.props,{className:k,onChange:this._onChange,ref:"mentionsInput"}))},focus:function j(){this.refs&&this.refs.mentionsInput&&this.refs.mentionsInput.focus()},insertEmoji:function j(k){this.refs&&this.refs.mentionsInput&&this.refs.mentionsInput.insertEmoji(k)},_onChange:function j(k){c("ReactComposerStatusActions").setMentions(this.context.composerID,c("ReactComposerStatusMentionsUtils").getMentionsFromEditorState(k));this.props.onChange&&this.props.onChange(k)}});f.exports=i}),null);